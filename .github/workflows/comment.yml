name: pr-build

on:
  issue_comment:
    types: [created]

jobs:
  trigger-self:
    runs-on: ubuntu-latest
    # Only run on pull-request comments
    if: ${{ github.event.issue.pull_request && github.event.comment.body == '/build-pr-image' }}

    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            console.log(context)

            const prNumber = context.issue.number
            const ref = `refs/pull/${prNumber}/merge`

            const response = await github.actions.createWorkflowDispatch({
              owner: 'your-username',
              repo: 'your-repo',
              workflow_id: 'ci.yml',
              ref: 'main'
            })
